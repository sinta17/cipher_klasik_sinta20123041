

    import numpy as np

    def mod_inverse(a, m):
        """Mencari invers modulo dari a (mod m)"""
        a = a % m
        for x in range(1, m):
            if (a * x) % m == 1:
                return x
        return None

    def matrix_mod_inverse(matrix, modulus):
        """Mencari invers dari matriks (mod 26)"""
        det = int(round(np.linalg.det(matrix)))  # determinan matriks
        det_inv = mod_inverse(det, modulus)      # invers dari determinan
        if det_inv is None:
            raise ValueError("Matriks kunci tidak memiliki invers (determinannya tidak relatif prima dengan 26).")

        # Hitung kofaktor dan adjoin
        matrix_cofactor = np.linalg.inv(matrix).T * det
        matrix_inv = (det_inv * matrix_cofactor) % modulus
        return np.round(matrix_inv).astype(int) % modulus

    def hill_encrypt(text, key):
        text = text.upper().replace(' ', '')
        n = int(len(key) ** 0.5)
        key = np.array(key).reshape(n, n)
        result = ''

        # Pastikan panjang text kelipatan n
        if len(text) % n != 0:
            text += 'X' * (n - len(text) % n)

        for i in range(0, len(text), n):
            block = [ord(c) - 65 for c in text[i:i+n]]
            cipher = np.dot(key, block) % 26
            result += ''.join(chr(c + 65) for c in cipher)

        return result

    def hill_decrypt(cipher, key):
        cipher = cipher.upper().replace(' ', '')
        n = int(len(key) ** 0.5)
        key = np.array(key).reshape(n, n)
        key_inv = matrix_mod_inverse(key, 26)
        result = ''

        for i in range(0, len(cipher), n):
            block = [ord(c) - 65 for c in cipher[i:i+n]]
            plain = np.dot(key_inv, block) % 26
            result += ''.join(chr(int(c) + 65) for c in plain)

        return result

    # Contoh penggunaan
    plaintext = 'CHEK'
    key = [3, 3, 2, 5]  # Matriks 2x2
    ciphertext = hill_encrypt(plaintext, key)
    decrypted = hill_decrypt(ciphertext, key)

    print("Plaintext :", plaintext)
    print("Key       :", key)
    print("Ciphertext:", ciphertext)
    print("Dekripsi  :", decrypted)

    Plaintext : CHEK
    Key       : [3, 3, 2, 5]
    Ciphertext: BNQG
    Dekripsi  : PEWO
